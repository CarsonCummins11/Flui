<!--
	Profile for an Influencer
-->
<!DOCTYPE html>
<html>
<head>
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:100i&display=swap" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css">
    <!-- The core Firebase JS SDK is always required and must be listed first -->
	<script src="https://www.gstatic.com/firebasejs/7.10.0/firebase-app.js"></script>
	
	<!-- TODO: Add SDKs for Firebase products that you want to use
		 https://firebase.google.com/docs/web/setup#available-libraries -->
	<script src="https://www.gstatic.com/firebasejs/7.10.0/firebase-analytics.js"></script>
	<script src="https://www.gstatic.com/firebasejs/7.10.0/firebase-auth.js"></script>

	<script>
	  // Your web app's Firebase configuration
	  var firebaseConfig = {
		apiKey: "AIzaSyDI0refre2q46_-Po8udToxs_aFWkYZcDQ",
		authDomain: "flui-3f8fe.firebaseapp.com",
		databaseURL: "https://flui-3f8fe.firebaseio.com",
		projectId: "flui-3f8fe",
		storageBucket: "flui-3f8fe.appspot.com",
		messagingSenderId: "677999224598",
		appId: "1:677999224598:web:78ceac8ce37e8936ebd237",
		measurementId: "G-23F80LNX69"
	  };
	  // Initialize Firebase
	  firebase.initializeApp(firebaseConfig);
	  firebase.analytics();
	</script>
	<script>
    $.fn.textWidth = function(_text, _font){//get width of text with font.  usage: $("div").textWidth();
        var fakeEl = $('<span>').hide().appendTo(document.body).text(_text || this.val() || this.text()).css({font: _font || this.css('font'), whiteSpace: "pre"}),
                    width = fakeEl.width();
        fakeEl.remove();
        return width;
    };
    $.fn.autoresize = function(options){//resizes elements based on content size.  usage: $('input').autoresize({padding:10,minWidth:0,maxWidth:100});
        options = $.extend({padding:0,minWidth:0,maxWidth:500}, options||{});
        $(this).on('input', function() {
            $(this).css('width', Math.min(options.maxWidth,Math.max(options.minWidth,$(this).textWidth() + options.padding)));
        }).trigger('input');
        return this;
    }
    function resetemail(){
        $('#emailtext').prop("readonly", true);
        $('body').focus();
        $('#ec').html('<span id="emailchange" class="change" onclick="changemail()">Change</span>');
    }
    function resetcompany(){
        $('#companytext').prop("readonly", true);
        $('body').focus();
        $('#cc').html('<span id="companychange" class="change" onclick="changecompany()">Change</span>');
    }
    function resetdesc(){
        $('#desctext').prop("readonly", true);
        $('body').focus();
        $('#dc').html('<span id="descchange" class="change" onclick="changedesc()">Change</span>');
    }
    function resetinsta(){
        $('#instatext').prop("readonly", true);
        $('body').focus();
        $('#ic').html('<span id="instachange" class="change" onclick="changinsta()">Change</span>');

    }
    function resettwitter(){
        $('#twittertext').prop("readonly", true);
        $('body').focus();
        $('#tc').html('<span id="twitterchange" class="change" onclick="changtwitter()">Change</span>');

    }
    function resetyoutube(){
        $('#youtubetext').prop("readonly", true);
        $('body').focus();
        $('#yc').html('<span id="youtubechange" class="change" onclick="changeyoutube()">Change</span>');

    }
    function getDataUri(url,callback) {
        var image = new Image();

        image.onload = function () {
            var canvas = document.createElement('canvas');
            canvas.width = this.naturalWidth; // or 'width' if you want a special/scaled size
            canvas.height = this.naturalHeight; // or 'height' if you want a special/scaled size

            canvas.getContext('2d').drawImage(this, 0, 0);

            // Get raw image data
            callback(canvas.toDataURL('image/png'));

        };

        image.src = url;
    }
    function resetimage(){
        console.log($('#fileinput')[0].files[0]);
        getDataUri(URL.createObjectURL($('#fileinput')[0].files[0]), function(dataUri) {$('#imagecontent').attr("src", dataUri)      
        dat = JSON.stringify({'img':dataUri});
        $.ajax({
            url:'/uploadimage',
            type:'POST',
            data: dat,
            contentType:'application/json; charset=UTF-8',
            success:function(data){console.log('fuck yea')}
        });
        });
        $('#ic').html('<span id="imagechange" class="change" onclick="changeimage()">Change</span>');
    }
    function changedesc(){
        $('#desctext').prop('readonly',false);
        $('#dc').html('<input onsubmit="resetdesc()" type="submit" value="Save Changes">');
        $('#desctext').focus();
    }
    function changemail(){
        $('#emailtext').prop('readonly',false);
        $('#ec').html('<input onsubmit="resetemail()" type="submit" value="Save Changes">');
        $('#emailtext').focus();
    }
    function changecompany(){
        $('#companytext').prop('readonly',false)
        $('#cc').html('<input onsubmit="resetcompany()" type="submit" value="Save Changes">')
        $('#companytext').focus();
    }
    function changeinsta(){
		$(location).attr('href', 'https://www.instagram.com/oauth/authorize/?client_id=1672949341&redirect_uri=https://flui.co&response_type=code')
        $('#instatext').prop('readonly',false)
        $('#ic').html('<input onsubmit="resetinsta()" type="submit" value="Save Changes">')
        $('#instatext').focus();
    }
    function changeyoutube(){
        $('#youtubetext').prop('readonly',false)
        $('#yc').html('<input onsubmit="resetyoutube()" type="submit" value="Save Changes">')
        $('#youtubetext').focus();
    }
    function changeimage(){
        console.log('Console logging 1');
        $('#ic').html('<span class="pickfile" aria-hidden="true"><input id="fileinput" type="file" accept="image/png, image/jpeg" multiple=false></span><div class="subimage" onclick="resetimage()">Update profile picture</div>');
    }
    function changetwitter(){
		var provider = new firebase.auth.TwitterAuthProvider();
		firebase.auth().signInWithPopup(provider).then(function(result) {
		  // This gives you a the Twitter OAuth 1.0 Access Token and Secret.
		  // You can use these server side with your app's credentials to access the Twitter API.
		  var token = result.credential.accessToken;
		  var secret = result.credential.secret;
		  // The signed-in user info.
		  var user = result.user;
		  console.log(user);
		  // ...
		}).catch(function(error) {
		  // Handle Errors here.
		  var errorCode = error.code;
		  var errorMessage = error.message;
		  // The email of the user's account used.
		  var email = error.email;
		  // The firebase.auth.AuthCredential type that was used.
		  var credential = error.credential;
		  // ...
        });
    }
    </script>
    <style>
    body{
        font-family: 'Montserrat', sans-serif;
        font-weight: 100;
        color:#707070;
        background-color: white;
        font-size: 5vw;
        overflow: hidden;
    }
    .change{
        font-family: 'Montserrat', sans-serif;
        color:#7B7B7B;
        font-style: italic;
        font-size: 1vw;
        cursor: pointer;
    }
	.inputTags{
		color:white;
		font-size:30%;
	}
    input{
        font-family: 'Montserrat', sans-serif;
        color:#707070;
        border:0;
        font-size: 5vw;
        font-style: italic;
        font-weight: 100;
        padding: 0px;
        background: none;
		text-align: "left";
    }
    .pickfile{
        font-family: 'Montserrat', sans-serif;
        color:#7B7B7B;
        font-style: italic;
        font-size: 1vw;
        cursor: pointer;
        background:white;
    }
    .subimage{
        font-family: 'Montserrat', sans-serif;
        color:#7B7B7B;
        font-style: italic;
        font-size: 1vw;
        cursor: pointer;
        background:white;
    }
    input[type=submit]{
        font-family: 'Montserrat', sans-serif;
        color:#7B7B7B;
        font-style: italic;
        font-size: 1vw;
        cursor: pointer;
    }
    input[type=text]:focus:read-write{
        outline: 0px;
        border-top: none;
        border-left: none;
        border-right: none;
        border-bottom: 3px solid #707070;
    }
    .descriptiontext{
        font-family: 'Montserrat', sans-serif;
        color:#707070;
        font-weight: lighter;
        font-size: 50%;
        text-align:left;
        border: 0px;
        outline: 0px;
        resize: none;
        overflow:hidden;
    }
    /*
    h1:after {
        display: block;
        clear: both;
        visibility: hidden;
    }
    */
    h1{
        font-family: 'Montserrat', sans-serif;
        color:white;
        font-style:italic;
        text-align:left;
        background:#212121;
        font-size: 70px;
        margin-top: -10px;
        margin-right:-10px;
        margin-left:-10px;
        margin-bottom: 0px;
        padding: -5px;
        font-weight:100;
        box-shadow: 0px 12px 17px  #707070;
        width: 102%;

        display: inline-block;
    }
    .proflabel{
        font-size:30%;
        padding:0;
        font-weight: 100;
        margin:-15px;
        margin-right: 0;
    }
    .search{
        cursor:pointer;
        float:right;
        font-size:56%;
        margin-right:30px;
        margin-top:20px;
        white-space: pre;
        
    }
    .media{
        float:right;
    }
    #notif-body{
        background:white;
        float:right;
        min-height: 300px;
        min-width: 200px;
        /*margin-top: 15px;*/
        margin-top: -400px;
        margin-right: 13px;
        box-shadow: 0px 12px 17px  #707070;
        overflow: auto;
    }
    #arrow-up {
        width: 0; 
        height: 0; 
        border-left: 13px solid transparent;
        border-right: 13px solid transparent;        
        border-bottom: 13px solid white;

        margin-left: 87px;
        margin-top: -12px;
    }
    </style>
</head>
<body>
    <h1>
    <span style="cursor:pointer" onclick="window.location.href = '/'">Flui</span>
    <span class="proflabel">Influencer Profile</span>
    <span class=search onclick="window.location.href='/influencersettings'"><i class="las la-bars"></i></span>
    <span id="notifbell" class = search onclick="notif_bar()"> <img src='/static/images/notificationbell.jpg' width="50px" height="50px"></span>
    <span class = search onclick="window.location.href='/searchforinfluencers'">Collab Search</span>
    <span class = search onclick="window.location.href='/viewrequest?user={{profile.user}}&r=0'">Ads  |</span>
    </h1>
    <div class="notif-page" id="notif-body">
        <div class="notif-page" id="arrow-up"></div>
        
    </div>
    <form id="userprofile" action="/influencerprofilechange" method="post">
        <div id="image">
            <img id="imagecontent" style="width:20;height:20;" src="{{profile.img}}">
            <span id='ic'>
                <span id="imagechange" class="change" onclick="changeimage()">Change</span>
            </span>
        </div>
        <span class="media">
            <div id="insta">
                <img style="width:45px;height:45px" src="/static/images/Instagram_Logo.png">
                <input id="instatext" type="text" name="instagram" value="{{profile.instagram}}" readonly=true>
                <span id='ic'><span id="instachange" class="change" onclick="changeinsta()">Change</span></span>
            </div>
            <div id="twitter">
                <img style="width:45px;height:45px;" src="/static/images/Twitter_Logo.png">
                <input id="twittertext" type="text" name="twitter" value="{{profile.twitter}}" readonly=true>
                <span id='tc'><span id="twitterchange" class="change" onclick="changetwitter()">Change</span></span>
            </div>
            <div id="youtube">
                <img style="width:64px;height:45px;" src="/static/images/Youtube_Logo.png">
                <input id="youtubetext" type="text" name="youtube" value="{{profile.youtube}}" readonly=true>
                <span id='yc'><span id="youtubechange" class="change" onclick="changeyoutube()">Change</span></span>
            </div>
            
        </span>
        <span id="company">
            <input id="companytext"type="text" name="fname" value="{{profile.name}}" readonly=true>
            <span id='cc'><span id="companychange" class="change" onclick="changecompany()">Change</span></span>
        </span><br>
        <span id="email">
            <input id="emailtext"type="text" name="email" value="{{profile.email}}" readonly=true>
            <span id='ec'><span id="emailchange" class="change" onclick="changemail()">Change</span></span>
        </span><br>
        <span style="float:left" id="description">
            <i>Description</i>
            <span id='dc'><span id="descchange" class="change" onclick="changedesc()">Change</span></span><br>
            <textarea rows=200 id='desctext'readonly=true maxlength=150 name=desc class="descriptiontext">{{profile.desc}}</textarea>
        </span>
    </form>
</body>
<script>
    var notifs_open = false;
	//Sizing code for emailtext, companytext, instatext, twittertext, youtubetext
    $('#emailtext').autoresize({padding:0,minWidth:40});
    $('#companytext').autoresize({padding:0,minWidth:40});
    $('#instatext').autoresize({padding:0,minWidth:40});
    $('#twittertext').autoresize({padding:0,minWidth:40});
    $('#youtubetext').autoresize({padding:0,minWidth:40});
    options = {padding:0,minWidth:40};
    options = $.extend({padding:0,minWidth:0,maxWidth:500}, options||{});
    //Resize text based on window size
	$(window).on('resize',function(){
        $('#emailtext').css('width', Math.min(options.maxWidth,Math.max(options.minWidth,$('#emailtext').textWidth() + options.padding)));
        $('#companytext').css('width', Math.min(options.maxWidth,Math.max(options.minWidth,$('#companytext').textWidth() + options.padding)));
        $('#instatext').css('width', Math.min(options.maxWidth,Math.max(options.minWidth,$('#instatext').textWidth() + options.padding)));
        $('#twittertext').css('width', Math.min(options.maxWidth,Math.max(options.minWidth,$('#twittertext').textWidth() + options.padding)));
        $('#youtubetext').css('width', Math.min(options.maxWidth,Math.max(options.minWidth,$('#youtubetext').textWidth() + options.padding)));
        
    });
	//Changes text area on key released
    $("textarea").on('keyup',function(){
        $("textarea").height( $("textarea")[0].scrollHeight);
        console.log(key);
    });
    function notif_bar(){
        if(!notifs_open){
            $("#notif-body").animate({
                marginTop: '10px'
            }, { duration: 400});
            notifs_open = true;
        }else{
            $("#notif-body").animate({
                marginTop: '-400px'
            }, { duration: 400});
            notifs_open = false;
        }
    };
</script>
</html>